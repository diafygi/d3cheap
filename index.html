<!DOCTYPE html>
<html>
    <head>
        <title>d3 on cheap smarphones</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <meta name="viewport" content="width=device-width, user-scalable=no">
        <style>
            /*http://meyerweb.com/eric/tools/css/reset/ v2.0 | 20110126 License: none (public domain)*/
            html, body, div, span, applet, object, iframe, h1, h2, h3, h4, h5, h6, p, blockquote, pre, a, abbr, acronym, address, big, cite, code, del, dfn, em, img, ins, kbd, q, s, samp, small,
            strike, strong, sub, sup, tt, var, b, u, i, center, dl, dt, dd, ol, ul, li, fieldset, form, label, legend, table, caption, tbody, tfoot, thead, tr, th, td, article, aside, canvas,
            details, embed, figure, figcaption, footer, header, hgroup, menu, nav, output, ruby, section, summary, time, mark, audio, video {margin:0; padding:0; border:0; font-size:100%; font:inherit; vertical-align:baseline;}
            /* HTML5 display-role reset for older browsers */
            article, aside, details, figcaption, figure, footer, header, hgroup, menu, nav, section {display:block;} body {line-height: 1;} ol, ul {list-style: none;}
            blockquote, q {quotes: none;} blockquote:before, blockquote:after, q:before, q:after {content:''; content:none;} table {border-collapse:collapse; border-spacing:0;}
        </style>
        <script src="d3.min.js" charset="utf-8"></script>
        <script src="zepto.min.js" charset="utf-8"></script>
        <style>
            body{font-family:"sans-serif";}
            #nextprev{margin:10px 0px 20px 10px;}
            #next, #prev{display:inline-block;text-decoration:none;font-weight:bold;padding:10px;margin-right:10px;background-color:#0000FF;color:#EEEEEE;border-radius:5px;}
            #title{display:inline-block;text-overflow:ellipsis;font-style:italic;font-size:20px;}
            #wrapper{text-align:center;}
            #slide{text-align:left;display:block;}
            textarea{display:none;}
            h1{text-align:center;font-size:30px;}
        </style>
    </head>
    <body>
        <div id="nextprev">
            <a id="prev" href="#">Prev</a>
            <a id="next" href="#">Next</a>
            <div id="title"></div>
        </div>
        <div id="wrapper">
            <div id="slide"></div>
        </div>
        <!--Using text areas for raw slide html storage so they don't preload-->
        <!--(I want to show real load times when tapping next)-->
        <!--Also, my syntax highlight still works within textareas-->
        <!--(makes coding easier than typing html into javascript variables)-->
        <textarea id="2" data-title="intro">
            <h1>d3 on cheap smarphones</h1>
        </textarea>


        <textarea id="3" data-title="support">
            <style>
                #svg-wrapper{margin-left:auto;margin-right:auto;}
            </style>
            <div id="svg-wrapper"></div>
            <script>
                //create a basic static svg layout
                var svg = d3.select("#svg-wrapper")
                    .append("svg")
                    .attr("width", 300)
                    .attr("height", 300);
                svg.append("circle")
                    .attr("cx", 200)
                    .attr("cy", 200)
                    .attr("r", 100)
                    .style("fill", "#0000FF");
                svg.append("circle")
                    .attr("cx", 110)
                    .attr("cy", 130)
                    .attr("r", 50)
                    .style("fill", "#00FF00");
                svg.append("text")
                    .text("SVG Works!")
                    .attr("x", 0)
                    .attr("y", 120)
                    .attr("transform", "rotate(-20)")
                    .style("stroke", "#FF3333")
                    .style("fill", "#FF3333")
                    .style("font-size", "40px");
                //check to see if there is an svg element
                if(!$("#svg-wrapper svg").length)
                    $("#svg-wrapper").html("<h1>[Cannot display svg]</h1>");
            </script>
        </textarea>


        <textarea id="4" data-title="static">
            <style>
                #svg-wrapper{width:300px;height:300px;margin-left:auto;margin-right:auto;}
                #add, #sub{margin:10px;text-decoration:none;font-weight:bold;font-size:35px;padding:10px 30px;margin-right:10px;background-color:#0000FF;color:#EEEEEE;border-radius:5px;}
                #add{float:right;}
                #sub{float:left;}
                #footer{width:100%}
                #count{padding-top:20px;font-size:35px;font-weight:bold;text-align:center;margin-left:auto;margin-right:auto;}
            </style>
            <div id="svg-wrapper" style=""></div>
            <div id="footer">
                <a id="sub" href="#">-</a>
                <a id="add" href="#">+</a>
                <div id="count">33</div>
            </div>
            <script>
                //add circle to svg positioned in box layout
                var n = 1;
                var size = 300;
                var pad = 0.15;
                function make_circles(){
                    $("#svg-wrapper").html("");
                    //generate circle locations
                    var data = [];
                    var dia = (size * (1 - pad)) / n;
                    var dist = (n == 1) ? 0 : dia + (size * pad / (n - 1));
                    for(var x = 0; x < n; x++)
                        for(var y = 0; y < n; y++)
                            data.push([x * dist + dia * 0.5, y * dist + dia * 0.5]);
                    //insert circles
                    var svg = d3.select("#svg-wrapper")
                        .append("svg")
                        .attr("width", size)
                        .attr("height", size);
                    svg.selectAll("circle")
                        .data(data).enter().append("circle")
                        .attr("cx", function(d){return d[0];})
                        .attr("cy", function(d){return d[1];})
                        .attr("r", dia * 0.5)
                        .style("fill", "#FF0000");
                    $("#count").html(n * n);
                }
                //bind add/subtract buttons
                $("#add").bind("click", function(e){
                    e.preventDefault();
                    n += 4;
                    make_circles();
                });
                $("#sub").bind("click", function(e){
                    e.preventDefault();
                    n = (n <= 1) ? 1 : n - 4;
                    make_circles();
                });
                make_circles();
            </script>
        </textarea>


        <textarea id="5" data-title="movement">
            <style>
                #svg-wrapper{width:300px;height:300px;margin-left:auto;margin-right:auto;}
                #add, #sub{margin:10px;text-decoration:none;font-weight:bold;font-size:35px;padding:10px 30px;margin-right:10px;background-color:#0000FF;color:#EEEEEE;border-radius:5px;}
                #add{float:right;}
                #sub{float:left;}
                #footer{width:100%}
                #count{padding-top:20px;font-size:35px;font-weight:bold;text-align:center;margin-left:auto;margin-right:auto;}
            </style>
            <div id="svg-wrapper" style=""></div>
            <div id="footer">
                <a id="sub" href="#">-</a>
                <a id="add" href="#">+</a>
                <div id="count"></div>
            </div>
            <script>
                //add circle to svg positioned in box layout
                var n = 1;
                var size = 250;
                var pad = 0.15;
                function make_circles(){
                    $("#svg-wrapper").html("");
                    //generate circle locations
                    var data = [];
                    var dia = (size * (1 - pad)) / n;
                    var dist = (n == 1) ? 0 : dia + (size * pad / (n - 1));
                    for(var x = 0; x < n; x++)
                        for(var y = 0; y < n; y++)
                            data.push([x * dist + dia * 0.5, y * dist + dia * 0.5]);
                    //insert circles
                    var svg = d3.select("#svg-wrapper")
                        .append("svg")
                        .attr("width", size + 50)
                        .attr("height", size + 50);
                    svg.selectAll("circle")
                        .data(data).enter().append("circle")
                        .attr("cx", function(d){return d[0];})
                        .attr("cy", function(d){return d[1];})
                        .attr("r", dia * 0.5)
                        .style("fill", "#FF0000");
                    //move the group of circles
                    (function move(cur_len){
                        svg.selectAll("circle")
                            .data(data)
                            .transition().duration(500)
                                .attr("cx", function(d){return d[0] + 50;})
                                .attr("cy", function(d){return d[1] + 50;})
                            .transition().duration(500)
                                .attr("cx", function(d){return d[0];})
                                .attr("cy", function(d){return d[1];})
                                .each("end", function(d, i){
                                    //only fire recursion on last circle
                                    if(i == data.length - 1){
                                        //break the recursion if changed number of circles
                                        var cir_len = 0;
                                        svg.selectAll("circle")
                                            .each(function(){cir_len++;});
                                        if(cur_len == cir_len)
                                            move(n * n);
                                    }
                                });
                    })(n * n);
                    $("#count").html(n * n);
                }
                //bind add/subtract buttons
                $("#add").bind("click", function(e){
                    e.preventDefault();
                    n += 4;
                    make_circles();
                });
                $("#sub").bind("click", function(e){
                    e.preventDefault();
                    n = (n <= 1) ? 1 : n - 4;
                    make_circles();
                });
                make_circles();
            </script>
        </textarea>


        <textarea id="6" data-title="force">
            <style>
                #svg-wrapper{width:300px;height:300px;margin-left:auto;margin-right:auto;}
                #add, #sub{margin:10px;text-decoration:none;font-weight:bold;font-size:35px;padding:10px 30px;margin-right:10px;background-color:#0000FF;color:#EEEEEE;border-radius:5px;}
                #add{float:right;}
                #sub{float:left;}
                #footer{width:100%}
                #count{padding-top:20px;font-size:35px;font-weight:bold;text-align:center;margin-left:auto;margin-right:auto;}
            </style>
            <div id="svg-wrapper" style=""></div>
            <div id="footer">
                <a id="sub" href="#">-</a>
                <a id="add" href="#">+</a>
                <div id="count"></div>
            </div>
            <script>
                //add circle to svg positioned in box layout
                var n = 2;
                var size = 300;
                var pad = 0.15;
                function make_force(){
                    $("#svg-wrapper").html("");
                    //generate initial nodes
                    var nodes = [];
                    var dia = (size * (1 - pad)) / n;
                    var dist = (n == 1) ? 0 : dia + (size * pad / (n - 1));
                    for(var x = 0; x < n; x++){
                        for(var y = 0; y < n; y++){
                            nodes.push({
                                "x": x * dist + dia * 0.5,
                                "y": y * dist + dia * 0.5,
                                "weight": Math.random() + 1.0,
                            });
                        }
                    }
                    //generate random links (via Fisher–Yates shuffle)
                    var range = [];
                    for(var i = 0; i < nodes.length; i++)
                        range.push(i);
                    var links = [];
                    var max_links = 8;
                    for(var i = 0; i < range.length; i++){
                        var shuf = range.slice(0);
                        var index;
                        var tmp;
                        for(var j = range.length - 1; j >= 0; j--){
                            index = Math.floor(j * Math.random());
                            tmp = shuf[index];
                            shuf[index] = shuf[j];
                            shuf[j] = tmp;
                        }
                        shuf = shuf.slice(0, Math.floor(max_links * Math.random()));
                        for(var j = 0; j < shuf.length; j++){
                            links.push({
                                "source": nodes[i],
                                "target": nodes[shuf[j]],
                            });
                        }
                    }
                    //insert force directed layout
                    var svg = d3.select("#svg-wrapper")
                        .append("svg")
                        .attr("width", size)
                        .attr("height", size);
                    var force = d3.layout.force()
                        .nodes(nodes)
                        .links(links)
                        .size([size, size])
                        .linkDistance(60)
                        .charge(-300)
                        .on("tick", function(){
                            link.attr("x1", function(d){return d['source']['x'];})
                                .attr("y1", function(d){return d['source']['y'];})
                                .attr("x2", function(d){return d['target']['x'];})
                                .attr("y2", function(d){return d['target']['y'];});
                            node.attr("transform", function(d){
                                return "translate(" + d['x'] + "," + d['y'] + ")";
                            });
                        })
                        .start();
                    var link = svg.selectAll("line")
                        .data(force.links())
                        .enter().append("line")
                        .style("stroke-width", "2px")
                        .style("stroke", "#333333");
                    var node = svg.selectAll("circle")
                        .data(force.nodes())
                        .enter().append("circle")
                        .style("fill", "#FF0000")
                        .style("stroke", "#FFDDDD")
                        .style("stroke-width", "2px")
                        .attr("r", 15);
                    $("#count").html(n * n);
                }
                //bind add/subtract buttons
                $("#add").bind("click", function(e){
                    e.preventDefault();
                    n += 1;
                    make_force();
                });
                $("#sub").bind("click", function(e){
                    e.preventDefault();
                    n = (n <= 4) ? 4 : n - 1;
                    make_force();
                });
                make_force();
            </script>
        </textarea>


        <textarea id="7" data-title="scaling">
            <style>
                #svg-wrapper{width:300px;height:300px;margin-left:auto;margin-right:auto;}
                #add, #sub{margin:10px;text-decoration:none;font-weight:bold;font-size:35px;padding:10px 30px;margin-right:10px;background-color:#0000FF;color:#EEEEEE;border-radius:5px;}
                #add{float:right;}
                #sub{float:left;}
                #footer{width:100%}
                #count{padding-top:20px;font-size:35px;font-weight:bold;text-align:center;margin-left:auto;margin-right:auto;}
            </style>
            <div id="svg-wrapper" style=""></div>
            <div id="footer">
                <a id="sub" href="#">-</a>
                <a id="add" href="#">+</a>
                <div id="count"></div>
            </div>
            <script>
                //add circle to svg positioned in box layout
                var n = 1;
                var size = 200;
                var pad = 0.40;
                function make_circles(){
                    $("#svg-wrapper").html("");
                    //generate circle locations
                    var data = [];
                    var dia = (size * (1 - pad)) / n;
                    var dist = (n == 1) ? 0 : dia + (size * pad / (n - 1));
                    for(var x = 0; x < n; x++)
                        for(var y = 0; y < n; y++)
                            data.push([x * dist + dia * 0.5, y * dist + dia * 0.5]);
                    //insert circles
                    var svg = d3.select("#svg-wrapper")
                        .append("svg")
                        .attr("width", size + 100)
                        .attr("height", size + 100);
                    svg.selectAll("circle")
                        .data(data).enter().append("circle")
                        .attr("cx", function(d){return d[0];})
                        .attr("cy", function(d){return d[1];})
                        .attr("r", dia * 0.5)
                        .style("fill", "#FF0000");
                    //scale the group of circles
                    (function move(cur_len){
                        svg.selectAll("circle")
                            .data(data)
                            .transition().duration(500)
                                .attr("transform", "scale(1.5)")
                            .transition().duration(500)
                                .attr("transform", "scale(1.0)")
                                .each("end", function(d, i){
                                    //only fire recursion on last circle
                                    if(i == data.length - 1){
                                        //break the recursion if changed number of circles
                                        var cir_len = 0;
                                        svg.selectAll("circle")
                                            .each(function(){cir_len++;});
                                        if(cur_len == cir_len)
                                            move(n * n);
                                    }
                                });
                    })(n * n);
                    $("#count").html(n * n);
                }
                //bind add/subtract buttons
                $("#add").bind("click", function(e){
                    e.preventDefault();
                    n += 4;
                    make_circles();
                });
                $("#sub").bind("click", function(e){
                    e.preventDefault();
                    n = (n <= 1) ? 1 : n - 4;
                    make_circles();
                });
                make_circles();
            </script>
        </textarea>


        <textarea id="8" data-title="hover">
            <style>
                #svg-wrapper{width:300px;height:300px;margin-left:auto;margin-right:auto;border:1px solid #000000;}
            </style>
            <div id="svg-wrapper" style=""></div>
            <script>
                //insert circle, move with mouse
                var svg = d3.select("#svg-wrapper")
                    .append("svg")
                    .attr("width", 300)
                    .attr("height", 300)
                    .on("mousemove", function(){
                        var coords = d3.mouse(this);
                        circle
                            .attr("cx", coords[0])
                            .attr("cy", coords[1]);
                    });
                var circle = svg.append("circle")
                    .attr("cx", 150)
                    .attr("cy", 150)
                    .attr("r", 40)
                    .style("fill", "#FF0000");
            </script>
        </textarea>


        <textarea id="9" data-title="touch">
            <style>
                #svg-wrapper{width:300px;height:300px;margin-left:auto;margin-right:auto;border:1px solid #000000;}
            </style>
            <div id="svg-wrapper" style=""></div>
            <script>
                //insert circle, move with touch
                var svg = d3.select("#svg-wrapper")
                    .append("svg")
                    .attr("width", 300)
                    .attr("height", 300)
                    .on("touchmove", function(){
                        var coords = d3.touches(this);
                        circle
                            .attr("cx", coords[0])
                            .attr("cy", coords[1]);
                    });
                var circle = svg.append("circle")
                    .attr("cx", 150)
                    .attr("cy", 150)
                    .attr("r", 40)
                    .style("fill", "#FF0000");
            </script>
        </textarea>


        <textarea id="10" data-title="multi-touch">
            10
        </textarea>


        <textarea id="11" data-title="interaction">
            11
        </textarea>


        <textarea id="12" data-title="lots-of-updates">
            12
        </textarea>


        <textarea id="13" data-title="hardware">
            13
        </textarea>


        <script>
            //overall slide functionality
            function load_slide(n){
                $("#title").html($("#"+n).data("title"));
                $("#slide").html($("#"+n).val());

                $("#next").unbind("click");
                $("#next").bind("click", function(e){
                    e.preventDefault();
                    load_slide(n < 13 ? n + 1 : 13);
                });

                $("#prev").unbind("click");
                $("#prev").bind("click", function(e){
                    e.preventDefault();
                    load_slide(n > 2 ? n - 1 : 2);
                });
            }
            load_slide(2);
        </script>
    </body>
</html>
